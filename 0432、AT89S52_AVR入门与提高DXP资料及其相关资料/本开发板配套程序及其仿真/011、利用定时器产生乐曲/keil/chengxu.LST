C51 COMPILER V8.05a   CHENGXU                                                              07/07/2009 17:30:19 PAGE 1   


C51 COMPILER V8.05a, COMPILATION OF MODULE CHENGXU
OBJECT MODULE PLACED IN chengxu.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE chengxu.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          /********************************************************************
   2                                      汇诚科技
   3                                                    http://www.ourhc.cn
   4          *********************************************************************/
   5          #include<reg52.h>              //库文件
   6          #define uchar unsigned char//宏定义无符号字符型
   7          #define uint unsigned int  //宏定义无符号整型
   8          /********************************************************************
   9                                      初始定义
  10          *********************************************************************/
  11          uchar Count;
  12          sbit _Speak =P3^7 ; //讯响器控制脚
  13          /********************************************************************
  14                                      歌曲字根码
  15          *********************************************************************/
  16          unsigned char code SONG[] ={ //祝你平安
  17          0x26,0x20,0x20,0x20,0x20,0x20,0x26,0x10,0x20,0x10,0x20,0x80,0x26,0x20,0x30,0x20,
  18          0x30,0x20,0x39,0x10,0x30,0x10,0x30,0x80,0x26,0x20,0x20,0x20,0x20,0x20,0x1c,0x20,
  19          0x20,0x80,0x2b,0x20,0x26,0x20,0x20,0x20,0x2b,0x10,0x26,0x10,0x2b,0x80,0x26,0x20,
  20          0x30,0x20,0x30,0x20,0x39,0x10,0x26,0x10,0x26,0x60,0x40,0x10,0x39,0x10,0x26,0x20,
  21          0x30,0x20,0x30,0x20,0x39,0x10,0x26,0x10,0x26,0x80,0x26,0x20,0x2b,0x10,0x2b,0x10,
  22          0x2b,0x20,0x30,0x10,0x39,0x10,0x26,0x10,0x2b,0x10,0x2b,0x20,0x2b,0x40,0x40,0x20,
  23          0x20,0x10,0x20,0x10,0x2b,0x10,0x26,0x30,0x30,0x80,0x18,0x20,0x18,0x20,0x26,0x20,
  24          0x20,0x20,0x20,0x40,0x26,0x20,0x2b,0x20,0x30,0x20,0x30,0x20,0x1c,0x20,0x20,0x20,
  25          0x20,0x80,0x1c,0x20,0x1c,0x20,0x1c,0x20,0x30,0x20,0x30,0x60,0x39,0x10,0x30,0x10,
  26          0x20,0x20,0x2b,0x10,0x26,0x10,0x2b,0x10,0x26,0x10,0x26,0x10,0x2b,0x10,0x2b,0x80,
  27          0x18,0x20,0x18,0x20,0x26,0x20,0x20,0x20,0x20,0x60,0x26,0x10,0x2b,0x20,0x30,0x20,
  28          0x30,0x20,0x1c,0x20,0x20,0x20,0x20,0x80,0x26,0x20,0x30,0x10,0x30,0x10,0x30,0x20,
  29          0x39,0x20,0x26,0x10,0x2b,0x10,0x2b,0x20,0x2b,0x40,0x40,0x10,0x40,0x10,0x20,0x10,
  30          0x20,0x10,0x2b,0x10,0x26,0x30,0x30,0x80,0x00,
  31          //路边的野华不要采
  32          0x30,0x1C,0x10,0x20,0x40,0x1C,0x10,0x18,0x10,0x20,0x10,0x1C,0x10,0x18,0x40,0x1C,
  33          0x20,0x20,0x20,0x1C,0x20,0x18,0x20,0x20,0x80,0xFF,0x20,0x30,0x1C,0x10,0x18,0x20,
  34          0x15,0x20,0x1C,0x20,0x20,0x20,0x26,0x40,0x20,0x20,0x2B,0x20,0x26,0x20,0x20,0x20,
  35          0x30,0x80,0xFF,0x20,0x20,0x1C,0x10,0x18,0x10,0x20,0x20,0x26,0x20,0x2B,0x20,0x30,
  36          0x20,0x2B,0x40,0x20,0x20,0x1C,0x10,0x18,0x10,0x20,0x20,0x26,0x20,0x2B,0x20,0x30,
  37          0x20,0x2B,0x40,0x20,0x30,0x1C,0x10,0x18,0x20,0x15,0x20,0x1C,0x20,0x20,0x20,0x26,
  38          0x40,0x20,0x20,0x2B,0x20,0x26,0x20,0x20,0x20,0x30,0x80,0x20,0x30,0x1C,0x10,0x20,
  39          0x10,0x1C,0x10,0x20,0x20,0x26,0x20,0x2B,0x20,0x30,0x20,0x2B,0x40,0x20,0x15,0x1F,
  40          0x05,0x20,0x10,0x1C,0x10,0x20,0x20,0x26,0x20,0x2B,0x20,0x30,0x20,0x2B,0x40,0x20,
  41          0x30,0x1C,0x10,0x18,0x20,0x15,0x20,0x1C,0x20,0x20,0x20,0x26,0x40,0x20,0x20,0x2B,
  42          0x20,0x26,0x20,0x20,0x20,0x30,0x30,0x20,0x30,0x1C,0x10,0x18,0x40,0x1C,0x20,0x20,
  43          0x20,0x26,0x40,0x13,0x60,0x18,0x20,0x15,0x40,0x13,0x40,0x18,0x80,0x00,};
  44          /********************************************************************
  45                                      定时中断服务函数
  46          *********************************************************************/
  47          void Time0_Init()
  48          { 
  49   1              TMOD = 0x01;
  50   1              IE = 0x82;
  51   1              TH0 = 0xD8;
  52   1              TL0 = 0xEF; //12MZ晶振，10ms
  53   1      }
  54          /*********************************************************************/
  55          void Time0_Int() interrupt 1
C51 COMPILER V8.05a   CHENGXU                                                              07/07/2009 17:30:19 PAGE 2   

  56          { 
  57   1              TH0 = 0xD8;
  58   1              TL0 = 0xEF;                      
  59   1              Count++; //长度加1
  60   1      }
  61          /*********************************************************************/
  62          void Delay_xMs(unsigned int x) //1MS 延时子程序
  63          { 
  64   1              unsigned int i,j;
  65   1              for( i =0;i < x;i++ )
  66   1              {
  67   2                      for( j =0;j<3;j++ );
  68   2              }
  69   1      }
  70          /*********************************************************************/
  71          void Play_Song(unsigned char i) //:歌曲播放子程序i 为播放哪一段曲目
  72          {
  73   1              unsigned char Temp1,Temp2;
  74   1              unsigned int Addr;
  75   1              Count = 0; //中断计数器清0
  76   1              Addr = i * 217;
  77   1      while(1)
  78   1              { 
  79   2                      Temp1 = SONG[Addr++];
  80   2                      if ( Temp1 == 0xFF ) //休止符
  81   2                              {
  82   3                                      TR0 = 0; Delay_xMs(100); 
  83   3                              }
  84   2              else if ( Temp1 == 0x00 ) //歌曲结束符
  85   2                      {
  86   3                              return;
  87   3                      }
  88   2      else 
  89   2      {
  90   3              Temp2 = SONG[Addr++];
  91   3              TR0 = 1;
  92   3              while(1)
  93   3              { 
  94   4              _Speak = ~_Speak;
  95   4              Delay_xMs(Temp1);
  96   4              if ( Temp2 == Count )
  97   4                      {
  98   5                              Count = 0;
  99   5                              break;
 100   5                      }
 101   4              }
 102   3      }
 103   2      }
 104   1      } 
 105          /********************************************************************
 106                                      主函数
 107          *********************************************************************/
 108          void main() //主程序
 109          {
 110   1              Time0_Init(); //定时器0 中断初始化
 111   1              while(1)
 112   1              {
 113   2                      Play_Song(0);
 114   2              } //播放
 115   1      }
 116          
 117          /********************************************************************
C51 COMPILER V8.05a   CHENGXU                                                              07/07/2009 17:30:19 PAGE 3   

 118                                        结束
 119          *********************************************************************/
 120          
 121          
 122          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    163    ----
   CONSTANT SIZE    =    407    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      1       3
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
