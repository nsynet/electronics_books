C51 COMPILER V8.05a   CHENGXU                                                              07/07/2009 00:07:58 PAGE 1   


C51 COMPILER V8.05a, COMPILATION OF MODULE CHENGXU
OBJECT MODULE PLACED IN chengxu.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE chengxu.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          /********************************************************************
   2                                      汇诚科技
   3                                                    http://www.ourhc.cn
   4          *********************************************************************/
   5          #include<reg52.h>              //库文件
   6          #define uchar unsigned char//宏定义无符号字符型
   7          #define uint unsigned int  //宏定义无符号整型
   8          /********************************************************************
   9                                      初始定义
  10          *********************************************************************/
  11          code uchar seg7code[10]={ 0xc0,0xf9,0xa4,0xb0,0x99,0x92,0x82,0xf8,0x80,0x90}; //显示段码 数码管字跟
  12          uchar wei[4]={0XEf,0XDf,0XBf,0X7f};  //位的控制端
  13          uchar sec; //定义计数值，每过1/10 秒，sec 加一
  14          uchar keycnt=0;//按下次数值
  15          uint tcnt; //键值判断
  16          sbit P3_0=P3^0;
  17          /********************************************************************
  18                                      延时函数
  19          *********************************************************************/
  20          void delay(uchar t)
  21          {
  22   1        uchar i,j;
  23   1         for(i=0;i<t;i++)
  24   1         {
  25   2               for(j=13;j>0;j--);
  26   2               { ;
  27   3               }
  28   2         }
  29   1      }
  30          
  31          /********************************************************************
  32                                      显示函数
  33          *********************************************************************/        
  34          void Led(int date) //显示函数
  35          {
  36   1      /*****************数据转换*****************************/ 
  37   1       uint z,x,c,v;
  38   1        z=date/1000;                   //求千位
  39   1        x=date%1000/100;               //求百位
  40   1        c=date%100/10;                 //求十位
  41   1        v=date%10;                     //求个位
  42   1      
  43   1            P2=0XFF;
  44   1                P0=seg7code[z];
  45   1                P2=wei[0];
  46   1                delay(80);
  47   1                P2=0XFF;  
  48   1            P0=seg7code[x];
  49   1                P2=wei[1];
  50   1                delay(80);
  51   1                P2=0XFF;  
  52   1                P0=seg7code[c];
  53   1                P2=wei[2];
  54   1                delay(80);
  55   1                P2=0XFF;  
C51 COMPILER V8.05a   CHENGXU                                                              07/07/2009 00:07:58 PAGE 2   

  56   1            P0=seg7code[v];
  57   1                P2=wei[3];
  58   1                delay(80); 
  59   1                P2=0XFF;
  60   1      }
  61          /********************************************************************
  62                                      按键扫描函数
  63          *********************************************************************/
  64          void KEY() //按键扫描程序
  65          {
  66   1      uchar i,j;
  67   1      if(P3_0==0)
  68   1              {
  69   2              delay(20);
  70   2              if(P3_0==0)
  71   2                      {
  72   3                              keycnt++;
  73   3      /********************************************************************
  74   3                                  按下次数判断函数
  75   3      *********************************************************************/
  76   3      switch(keycnt) //按下次数判断
  77   3              {
  78   4              case 1: //第一次按下
  79   4              TH0=0x06; //对TH0 TL0 赋值
  80   4              TL0=0x06;
  81   4              TR0=1; //开始定时
  82   4              break;
  83   4              case 2: //第二次按下
  84   4              TR0=0; //定时结束
  85   4              break;
  86   4              case 3: //第三次按下
  87   4              keycnt=0; //重新开始判断键值
  88   4              sec=0; //计数重新从零开始
  89   4              break;
  90   4              }
  91   3              while(P3_0==0);
  92   3                      } 
  93   2              }
  94   1      }
*** WARNING C280 IN LINE 66 OF CHENGXU.C: 'i': unreferenced local variable
*** WARNING C280 IN LINE 66 OF CHENGXU.C: 'j': unreferenced local variable
  95          /********************************************************************
  96                                      定时中断服务函数
  97          *********************************************************************/
  98          void t0(void) interrupt 1 using 0 //定时中断服务函数
  99          {
 100   1              tcnt++; //每过250ust tcnt 加一
 101   1              if(tcnt==400) //计满400 次（1/10 秒）时
 102   1              {
 103   2                      tcnt=0; //重新再计
 104   2                      sec++;
 105   2                      if(sec==100) //定时10 秒，在从零开始计时
 106   2                      {
 107   3                              sec=0;
 108   3                      }
 109   2              }
 110   1      }
 111          
 112          /********************************************************************
 113                                      主函数
 114          *********************************************************************/
 115          void main()
C51 COMPILER V8.05a   CHENGXU                                                              07/07/2009 00:07:58 PAGE 3   

 116          {
 117   1              TMOD=0x02; //定时器工作在方式2
 118   1              ET0=1;
 119   1              EA=1;
 120   1              sec=0;
 121   1              while(1)
 122   1              {
 123   2                      KEY();
 124   2                      Led(sec);
 125   2              }
 126   1      }               
 127          
 128                  
 129          /********************************************************************
 130                                        结束
 131          *********************************************************************/


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    284    ----
   CONSTANT SIZE    =     10    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      8       6
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  2 WARNING(S),  0 ERROR(S)
